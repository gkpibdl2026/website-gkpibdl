# 2026-01-20

## Features

### Renungan Harian (Daily Devotion) - NEW FEATURE

- **Full Feature Implementation**: Modul baru "Renungan Harian" untuk menampilkan renungan harian di homepage dan admin panel.
- **RSS Sync dari GKPI Sinode**: Otomatis mengambil konten renungan dari feed [Terang Hidup GKPI Sinode](https://gkpisinode.org/category/terang-hidup/feed/).
- **HTML Content Stripping**: Membersihkan tag HTML dari konten RSS sebelum parsing.
- **Timezone Fix (WIB)**: Konversi tanggal publikasi dari UTC ke WIB (UTC+7) untuk akurasi tanggal Indonesia.
- **Admin CRUD**: Halaman admin lengkap untuk Create, Read, Update, Delete renungan (`/admin/renungan`).
- **Bulk Delete**: Fitur "Hapus Semua" untuk membersihkan seluruh data renungan sekaligus dengan konfirmasi modal.
- **Lazy Auto-Sync**: Homepage otomatis melakukan sync di background jika renungan hari ini belum tersedia.

## Database Migrations

- `010_renungan_table.sql`: Tabel baru `renungan` dengan RLS policies dan indexes.
- `011_fix_renungan_unique.sql`: Mengubah unique constraint dari `date` ke `source_url`, extend kolom `referensi` dan `lagu` ke TEXT.

## API Endpoints (New)

- `GET/POST /api/renungan` - List all / Create new
- `GET/PUT/DELETE /api/renungan/[id]` - Single item operations
- `POST /api/renungan/sync` - Sync dari RSS GKPI Sinode
- `GET /api/renungan/today` - Fetch renungan hari ini (dengan flag `is_today`)
- `DELETE /api/renungan/all` - Hapus semua data

## UI/UX Improvements

- **Admin Sidebar Fix**: Menambahkan overflow scroll pada navigasi sidebar untuk mencegah overlap dengan tombol Logout.
- **Custom Confirm Modal**: Mengganti `window.confirm()` browser dengan modal konfirmasi custom yang konsisten dengan design system.
- **Notification Standardization**: Mengganti semua `showNotification` menjadi `showToast` pada halaman admin renungan.

### Reading Experience (NEW)

- **Font Serif**: Menggunakan font serif pada ayat kunci dan isi renungan untuk kenyamanan membaca teks panjang.
- **Font Size Controls**: Tombol A+/A- untuk memperbesar/perkecil ukuran font (range 14px-24px).
- **Estimated Reading Time**: Menampilkan estimasi waktu baca (⏱️ X menit) berdasarkan ~200 kata/menit.
- **Share/Copy Feature**: Tombol "Salin Renungan" dan "Bagikan via WhatsApp" dengan format teks rapi.

### Public Pages (NEW)

- **Halaman List Renungan** (`/renungan`): Menampilkan daftar semua renungan dengan preview.
- **Halaman Detail Renungan** (`/renungan/[id]`): Tampilan lengkap dengan ayat kunci, isi, lagu, dan doa terpisah.
- **Homepage Card Clickable**: Card renungan di homepage sekarang bisa diklik ke halaman detail.
- **"Renungan Lainnya" Link**: Tombol navigasi ke halaman list renungan.

## Bug Fixes

- **Date Parsing Priority**: Memprioritaskan tanggal dari teks konten (Regex) dibanding `pubDate` XML untuk akurasi.
- **Reference Regex**: Memperbaiki regex untuk menangkap referensi ayat dengan spasi (contoh: `Rut 1 : 16`).
- **Lint Fixes**: Menambahkan `useCallback` pada `fetchRenungan`, memperbaiki destructuring `let/const`.
- **Lagu/Doa Separation**: Memperbaiki regex agar lagu tidak mencampur teks doa.
- **Duplicate Ayat Removal**: Menghapus ayat kunci dari isi renungan agar tidak muncul 2x.
- **Garbage Text Cleanup**: Menghapus "The post ... first appeared on GKPI Sinode" dari doa dan lagu.

## Files Added

- `sql/migrations/010_renungan_table.sql` - Tabel renungan dengan RLS
- `sql/migrations/011_fix_renungan_unique.sql` - Fix unique constraint
- `src/features/renungan/types/index.ts` - Type definitions
- `src/features/renungan/services/index.ts` - RSS parsing logic
- `src/features/renungan/components/RenunganCard.tsx` - UI component
- `src/features/renungan/index.ts` - Barrel export
- `src/app/admin/renungan/page.tsx` - Admin list page
- `src/app/admin/renungan/new/page.tsx` - Admin create page
- `src/app/admin/renungan/[id]/page.tsx` - Admin edit page
- `src/app/api/renungan/route.ts` - GET/POST endpoints
- `src/app/api/renungan/[id]/route.ts` - Single item endpoints
- `src/app/api/renungan/sync/route.ts` - RSS sync endpoint
- `src/app/api/renungan/today/route.ts` - Today's renungan endpoint
- `src/app/api/renungan/all/route.ts` - Bulk delete endpoint
- `src/app/(public)/renungan/page.tsx` - Public list page (NEW)
- `src/app/(public)/renungan/[id]/page.tsx` - Public detail page (NEW)

## Files Modified

- `src/app/(public)/page.tsx` - Homepage integration with lazy sync, clickable card
- `src/app/admin/layout.tsx` - Sidebar navigation fix
- `src/app/login/page.tsx` - Login page updates
- `src/components/layout/Footer.tsx` - Footer component updates
- `package.json` - Dependencies update (rss-parser)

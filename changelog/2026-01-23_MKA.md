# 2026-01-23

## Features

### Google Maps Integration (2026-01-23)

- **GoogleMapComponent**: Komponen peta interaktif untuk menampilkan lokasi gereja.
  - Menggunakan Google Maps JavaScript API.
  - Marker lokasi dengan koordinat GKPI.
  - Responsive dan mobile-friendly.
- **Contact Page**: Integrasi peta di halaman kontak (`/kontak`).
- **Environment Variables**: Konfigurasi `NEXT_PUBLIC_GOOGLE_MAPS_API_KEY`.

### Modul Warta - Jemaat Sakit (New)

- **JemaatSakitEditor**: Editor baru untuk mengelola daftar pokok doa jemaat sakit.
  - Input nama jemaat, lokasi (RS/Rumah), dan keterangan opsional.
  - Drag-and-drop reordering untuk mengatur urutan.
- **Public View**: Tampilan tabel responsif di halaman Warta publik.

### Pengaturan Pembayaran Admin (New Feature)

- **Database Migration**: Tabel `payment_settings` baru dengan kolom `qris_image_url` dan `bank_accounts` (JSONB array).
- **API Endpoints**:
  - `GET /api/payment-settings` - Mengambil pengaturan pembayaran.
  - `PUT /api/payment-settings` - Memperbarui pengaturan (admin only).
- **Admin Page** (`/admin/pembayaran`):
  - Upload gambar QRIS dengan preview dan validasi ukuran/tipe file.
  - Manajemen rekening bank (tambah, edit, hapus).
  - Pilihan warna tema untuk setiap rekening (blue, green, purple, orange, amber).
- **Sidebar Navigation**: Menu "Pembayaran" baru dengan ikon QRIS di admin sidebar.
- **Public Page Update**: Halaman `/keuangan` sekarang mengambil data QRIS dan rekening bank secara dinamis dari API.

## UI/UX Improvements

### Kontras Warna Rekening Bank

- **Text Visibility**: Memperbaiki kontras warna teks pada tampilan rekening bank di admin pembayaran.
  - Nama bank menggunakan `text-gray-900!` untuk warna hitam yang konsisten.
  - Nomor rekening dan nama pemegang menggunakan warna gelap dengan `!important`.
- **Color Options**: Memperbarui pilihan warna background rekening ke versi lebih terang (contoh: `bg-blue-100` alih-alih `bg-blue-50`).

### Custom Scrollbar Admin Sidebar

- **Styling**: Scrollbar sidebar admin sekarang menggunakan warna biru gelap yang sesuai dengan tema.
  - Track: Transparan atau `#152d45`.
  - Thumb: `#3b5a7c` dengan hover `#4a6d91`.
  - Width: 8px dengan border-radius 4px.
- **Compatibility**: Mendukung webkit (Chrome, Edge, Safari) dan Firefox (scrollbar-color).

## Refactor & Code Quality

### ToastProvider Global

- **Fix**: Menambahkan `ToastProvider` ke `src/components/Providers.tsx` untuk mengatasi error "useToast must be used within ToastProvider" saat build.

### Supabase Client Consistency

- **API Route Fix**: Memperbaiki `src/app/api/payment-settings/route.ts` untuk menggunakan `supabaseAdmin` sesuai konvensi project.

### Tailwind v4 Compatibility

- **Warning Fix**: Mengganti `max-w-[250px]` dengan `max-w-62.5` di halaman admin pembayaran.

## Database

### Migration: 012_payment_settings.sql

```sql
-- Tabel payment_settings dengan pola singleton
-- Kolom: qris_image_url (TEXT), bank_accounts (JSONB)
-- RLS policies untuk SELECT (public) dan UPDATE (authenticated)
-- Trigger updated_at
```

## Files Added

- `src/components/GoogleMapComponent.tsx` - Komponen Google Maps interaktif
- `src/features/warta/components/JemaatSakitEditor.tsx` - Editor jemaat sakit dengan DnD
- `src/app/api/payment-settings/route.ts` - API endpoints pembayaran
- `src/app/admin/pembayaran/page.tsx` - Halaman admin pengaturan pembayaran
- `sql/migrations/012_payment_settings.sql` - Database migration

## Files Modified

- `src/app/(public)/kontak/page.tsx` - Integrasi Google Maps component
- `src/app/(public)/kontak/ContactMap.tsx` - Wrapper untuk Google Maps
- `src/features/warta/components/ModuleRenderer.tsx` - Register JEMAAT_SAKIT editor
- `src/features/warta/components/WartaPublicViewer.tsx` - Tambah tampilan JEMAAT_SAKIT
- `src/features/warta/components/WartaModuleBuilder.tsx` - Update preview untuk JEMAAT_SAKIT
- `src/app/admin/layout.tsx` - Tambah menu Pembayaran dengan ikon QRIS, custom scrollbar class
- `src/app/(public)/keuangan/page.tsx` - Integrasi API pembayaran dinamis
- `src/components/Providers.tsx` - Tambah ToastProvider
- `src/app/globals.css` - Tambah styling custom scrollbar admin sidebar
